DATASETS = ["FIVES", "Fundus-AVSeg", "leuven-haifa"]
RESOLUTIONS = ["576", "1024"]
k = range(3, 9)
configfile: "config.yaml"

# 1) Include all rule files (order here doesn't really matter,
#    but we keep it in logical pipeline order for sanity)
include: "./rules/vascxgray_to_rgb.smk"
include: "./rules/copy_meta.smk"
include: "./rules/create_roi_masks.smk"
include: "./rules/binarize_masks.smk"
include: "./rules/downsample.smk"
include: "./rules/refinement.smk"

rule all:
    input:
        # Final desired outputs: refinement for Fundus-AVSeg at all k, resolutions
        expand(
            rules.refinement.output.refined,
            dataset=["Fundus-AVSeg", "FIVES", "leuven-haifa"],
            res=RESOLUTIONS,
            k=k,
        ),
    log:
        err = "logs/all.err",
        out = "logs/all.out"
    
    benchmark:
        "benchmarks/all.txt"


